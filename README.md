# سیستم وام قرض‌الحسنه (Qard al-Hasanah System)

یک سیستم مدیریت وام قرض‌الحسنه مبتنی بر وب با پشتیبانی از تقویم شمسی و رابط کاربری فارسی.

## امکانات

- ثبت نام و ورود کاربران
- پنل مدیریت برای مدیران
- مدیریت کاربران (اضافه، ویرایش، حذف)
- مدیریت وام‌ها (اضافه، ویرایش، تایید/رد)
- مدیریت اقساط (اضافه، ویرایش، ثبت پرداخت)
- درخواست وام توسط کاربران
- مشاهده وضعیت وام‌ها و اقساط پرداختی توسط کاربران
- گزارش‌های آماری و نمودارها
- پشتیبانی از تقویم شمسی (جلالی)
- پیام‌های فلش برای اطلاع‌رسانی به کاربران
- قابلیت پشتیبان‌گیری و بازیابی پایگاه داده در فرمت JSON

## نیازمندی‌ها

- Python 3.7 یا بالاتر
- PostgreSQL
- پکیج‌های مورد نیاز پایتون که در `pyproject.toml` مشخص شده‌اند

## نصب و راه‌اندازی

1. دریافت کد منبع:
```bash
git clone https://github.com/yourusername/qard-al-hasanah.git
cd qard-al-hasanah
```

2. ایجاد محیط مجازی و نصب وابستگی‌ها:
```bash
python -m venv venv
source venv/bin/activate  # در لینوکس/مک
# یا
venv\Scripts\activate  # در ویندوز

# نصب وابستگی‌ها
pip install -r requirements.txt
```

3. تنظیم متغیرهای محیطی:
```bash
# در لینوکس/مک
export DATABASE_URL="postgresql://username:password@localhost:5432/qard_al_hasanah"
export FLASK_SECRET_KEY="your-secret-key"

# در ویندوز (CMD)
set DATABASE_URL=postgresql://username:password@localhost:5432/qard_al_hasanah
set FLASK_SECRET_KEY=your-secret-key
```

4. راه‌اندازی پایگاه داده و اجرای برنامه:
```bash
python main.py
```

5. دسترسی به برنامه:
برنامه در آدرس http://localhost:5000 قابل دسترسی خواهد بود.

## مشخصات مدیر پیش‌فرض

پس از راه‌اندازی اولیه، یک کاربر مدیر با مشخصات زیر به صورت خودکار ایجاد می‌شود:
- نام کاربری: admin
- رمز عبور: admin123

## پشتیبان‌گیری و بازیابی داده‌ها

### پشتیبان‌گیری از داده‌ها
برای ایجاد فایل‌های پشتیبان از داده‌ها در قالب JSON، دستور زیر را اجرا کنید:
```bash
python export_db.py
```
این دستور فایل‌های پشتیبان را در پوشه `data` ایجاد می‌کند.

### بازیابی داده‌ها از پشتیبان
برای بازیابی داده‌ها از فایل‌های پشتیبان، دستور زیر را اجرا کنید:
```bash
python import_db.py
```
**نکته:** به صورت پیش‌فرض، داده‌های موجود حفظ می‌شوند و داده‌های پشتیبان به آن‌ها اضافه می‌شوند. برای پاک کردن داده‌های موجود قبل از بازیابی، متغیر `clear_existing` را در فایل `import_db.py` به `True` تغییر دهید.

## فایل‌های اصلی

- `main.py`: فایل اصلی برای اجرای برنامه
- `app.py`: تنظیمات اصلی برنامه و پایگاه داده
- `models.py`: تعریف مدل‌های پایگاه داده
- `forms.py`: تعریف فرم‌های ورودی
- `routes.py`: تعریف مسیرها و کنترلرها
- `utils.py`: توابع کمکی
- `templates/`: قالب‌های HTML
- `static/`: فایل‌های استاتیک (CSS، JavaScript، تصاویر)
- `export_db.py`: اسکریپت پشتیبان‌گیری از پایگاه داده
- `import_db.py`: اسکریپت بازیابی پایگاه داده

## نمودار سیستم

سیستم شامل سه بخش اصلی است:
1. **بخش کاربران**: مدیریت و نگهداری اطلاعات کاربران، ثبت نام و احراز هویت.
2. **بخش وام‌ها**: مدیریت درخواست‌ها و تأیید وام‌ها.
3. **بخش اقساط**: مدیریت اقساط وام‌ها و پیگیری پرداخت‌ها.

## مجوز

این پروژه تحت مجوز MIT منتشر شده است.